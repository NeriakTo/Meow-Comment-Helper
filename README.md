# 🐱 喵嗚評語助手 (Meow Comment Helper) V7.1

> **資安與隱私強化版 (Security & Privacy Hardening)**
> 專為國小導師打造的療癒系評語工具，溫暖的介面設計搭配強大的行政對接功能，現在更加注重您的隱私與資料安全！

![Version](https://img.shields.io/badge/version-7.1-slate)
![Security](https://img.shields.io/badge/Security-Hardened-blueviolet)
![Tech](https://img.shields.io/badge/Vue.js-3.0-green)
![UI](https://img.shields.io/badge/UI-Warm_Cat_Café-FFB74D)
![RWD](https://img.shields.io/badge/RWD-Mobile_First-blue)
![AI](https://img.shields.io/badge/Gemini-2.0-purple)
![Backend](https://img.shields.io/badge/Google_Apps_Script-BYOB-orange)
![Export](https://img.shields.io/badge/Excel-Dual_Header-success)

## 📖 專案概述 (Overview)

本系統為基於 Web 的單頁應用程式 (SPA)，旨在協助導師利用生成式 AI (Gemini)，將口語觀察紀錄轉化為教育專業評語。

**V7.1 資安與隱私強化版** 延續 V7.0 溫暖療癒的「貓咪咖啡廳」風格，同時大幅強化資料安全機制。無論您是在學校公用電腦使用，還是擔心雲端資料外洩，V7.1 都能為您提供安心的防護罩。**我們相信，好用的工具也該是安全的工具。** 🔐

---

## 🔒 V7.1 資安與隱私強化 (Security Features)

V7.1 新增四大防護機制，讓您安心使用：

### 💻 公用電腦模式 (Public Mode)

在輸入 API Key 時，可勾選「**💻 此為公用電腦 (不儲存金鑰)**」選項。

| 模式 | API Key 儲存位置 | 關閉視窗後 |
|------|------------------|------------|
| **一般模式** | 瀏覽器 LocalStorage | 保留，下次自動載入 |
| **公用模式** | 僅記憶體 (RAM) | 自動消失，需重新輸入 |

> 💡 適用情境：在學校公用電腦、圖書館電腦或借用他人設備時使用，確保離開後不留痕跡。

---

### 🗑️ 一鍵清除敏感資料 (Panic Button)

位於「☁️ 雲端同步」視窗底部的 **紅色按鈕**，可瞬間清除所有敏感憑證：

- ✅ 清除 API Key
- ✅ 清除 GAS 網址
- ✅ 清除通關密語
- ✅ 強制重新整理頁面
- ❌ **不會**清除班級資料 (放心！)

> 💡 適用情境：緊急情況下快速清除敏感資訊，或定期清理使用痕跡。

---

### 🔐 雲端通關密語 (GAS Secret Token)

雲端同步功能新增「**通關密語**」驗證機制：

1. 在「雲端同步」視窗輸入您的專屬密語 (預設: `meow1234`)
2. 同步時，密語會與資料一起傳送至 GAS 後端
3. 後端驗證密語正確才允許讀寫

```javascript
// GAS 後端驗證邏輯示意
if (payload.secret !== SECRET) {
    return { result: "error", message: "密語錯誤" };
}
```

> ⚠️ **重要**：請務必修改預設密語！在 GAS 程式碼中將 `var SECRET = "meow1234"` 改為您的專屬密語。

---

### 🛡️ Excel 匯出消毒 (Input Sanitization)

匯出 Excel 時，系統會自動檢測並處理特殊字元，防止 **公式注入攻擊 (Formula Injection)**：

| 原始輸入 | 消毒後輸出 | 說明 |
|----------|------------|------|
| `=SUM(A1:A10)` | `'=SUM(A1:A10)` | 加上前綴單引號 |
| `+886912345678` | `'+886912345678` | 防止被解析為公式 |
| `-100` | `'-100` | 防止減法運算 |
| `@mention` | `'@mention` | 防止 @ 觸發函式 |

> 💡 此防護機制可避免惡意使用者透過輸入特殊字元，在 Excel 開啟時執行非預期的公式或外部連結。

---

## ✨ V7.0 核心亮點 (延續)

### 🎨 全新視覺體驗 - 貓咪咖啡廳風格

| 設計元素 | 實作細節 |
|----------|----------|
| **字型** | 採用 `Varela Round` (圓潤標題) + `Noto Sans TC` (清晰內文) 雙字型組合 |
| **配色** | 米奶油色背景 `#FFF8F0`、拿鐵棕文字 `#5D4037`、淺橘主色 `#FFB74D` |
| **圓角** | 所有元件採用 `rounded-2xl` ~ `rounded-3xl` 超圓潤設計 |
| **動效** | 按鈕 hover 縮放、Tab 切換位移、淡入淡出轉場 |

> 💡 設計理念：減少冰冷的行政工具感，創造舒適的閱讀與操作環境，讓老師在繁忙的期末也能感受到一絲療癒。

---

### 🧙 新手引導精靈 (Welcome Wizard)

首次使用時，系統會自動彈出 **三步驟引導流程**，手把手教您完成設定：

1. **👋 歡迎頁**：親切的問候與功能簡介
2. **🥫 領取罐罐**：一鍵前往 Google AI Studio 申請免費 API Key
3. **✨ 餵食罐罐**：貼上 Key 即可啟動助手 (可勾選公用電腦模式)

> 💡 想再看一次教學？點擊頂部導覽列 API Key 旁的 **❓** 圓形按鈕即可重新開啟！

---

### ☁️ 內嵌雲端教學 (Embedded GAS Tutorial)

在「雲端同步」設定視窗中，我們提供 **摺疊式教學區塊**：

- 📋 **Step 1**：一鍵複製 GAS 程式碼 (已含驗證機制)
- 🆕 **Step 2**：前往 Google Apps Script 建立專案
- 🚀 **Step 3**：部署為網頁應用程式
- 🔗 **Step 4**：取得網址並貼回

> ⚠️ **V7.1 更新**：新版 GAS 程式碼已包含「通關密語」驗證邏輯，請記得：
> 1. 修改程式碼中的 `var SECRET = "meow1234"` 為您的專屬密語
> 2. 在「雲端同步」視窗填入相同的密語

---

### 📊 行為量表強化

| 優化項目 | 說明 |
|----------|------|
| **⚡ 一鍵預設按鈕** | 採用醒目的 **翠綠色** (`emerald-500`)，在橘色介面中成為明顯的「綠色通道」 |
| **📖 題目文字放大** | 從 `text-xs` 升級為 `text-[15px]`，搭配 `font-medium` 字重，大幅提升閱讀舒適度 |
| **📱 RWD 優化** | 手機版下拉選單全寬顯示、卡片間距縮減、高度自適應 |

---

### 📱 RWD 響應式設計升級

| 裝置 | 側邊欄 | 主內容區 | 圓角 |
|------|--------|----------|------|
| **手機版** | 85% 螢幕寬、僅右側圓角、滑入式動畫 | 全屏無邊距 | 減少圓角 |
| **桌面版** | 固定 320px、四邊留白、懸浮卡片 | 四邊留白、外框邊框 | 完整圓角 |

---

## 🌟 延續自 V6.x 的功能

### 📑 分頁式操作介面 (Tabbed UI)

- **📝 評語生成**：AI 雙語氣引擎，產出暖心評語 + 嚴謹箴言
- **📊 行為量表**：5 大類 25 項指標，內建一鍵預設
- **🏆 多元紀錄**：團體活動、公共服務、特殊表現完整記錄

### 🎯 學務系統完美對接

- **雙層表頭匯出**：含合併儲存格，100% 相容學校匯入格式
- **雙層表頭匯入**：索引定位解析，自動偵測年級班序
- **班級編輯功能**：可隨時修正年級、班序與別名

### ⏱️ 穩定性保障

- **15 秒逾時保護**：自動切換備用模型，避免卡住
- **LocalStorage 自動儲存**：深度監聽，輸入即存
- **雲端同步**：一鍵備份至 Google Sheets (含密語驗證)

---

## 🚀 快速開始 (Quick Start)

### 🌐 線上版 (推薦)

1. 開啟 GitHub Pages 網址
2. 跟隨 **新手引導精靈** 完成 API Key 設定
3. 點擊左上角「🏡 貓窩管理」建立班級
4. 選擇學生、輸入觀察紀錄、點擊「🐾 幫我寫」

### 💻 單機版

1. 下載 ZIP 並解壓縮
2. 雙擊 `index.html` 開啟
3. 操作同線上版

### ⚙️ 進階設定 (Config 檔)

建立 `config.js` 並填入：

```javascript
window.APP_CONFIG = {
    GEMINI_API_KEY: "您的_AIza_開頭金鑰",
    GAS_URL: "您的_Google_Script_網址"
};
```

---

## 📋 三步驟工作流 (Workflow)

### Step 1: 建立與觀察 (Tab 1 - 📝 評語生成)

1. 點擊「🏡 貓窩管理」建立班級（輸入年級、班序、人數）
2. 選擇學生，輸入姓名與觀察紀錄
3. 點擊「🐾 幫我寫」生成評語

### Step 2: 行為評量 (Tab 2 - 📊 行為量表)

1. 切換至「📊 行為量表」頁籤
2. 點擊 **⚡ 一鍵預設** 快速填入「大部分符合」
3. 針對例外項目微調，輸入具體建議

### Step 3: 多元紀錄 (Tab 3 - 🏆 多元紀錄)

1. 切換至「🏆 多元紀錄」頁籤
2. 輸入團體活動、公共服務、特殊表現
3. 點擊右上角 **📥 匯出** 下載 Excel

---

## 📐 技術架構 (Architecture)

| 層級 | 技術 |
|------|------|
| **前端框架** | Vue.js 3 (Composition API) |
| **樣式框架** | Tailwind CSS |
| **字型** | Google Fonts (Varela Round, Noto Sans TC) |
| **資料處理** | SheetJS (xlsx) |
| **本地儲存** | Browser LocalStorage |
| **雲端儲存** | Google Sheets (BYOB 架構) |
| **AI 引擎** | Google Gemini API |
| **資安防護** | Formula Injection 消毒、GAS Token 驗證、公用模式 |

---

## 📝 版本歷程 (Changelog)

### V7.1 (2026-01-16) - 資安與隱私強化版 🔒

**🔐 隱私防護**
- 新增「**公用電腦模式**」，支援 API Key 不落地使用，關閉視窗即焚
- 新增頂部工具列「💻 公用」快速勾選 (桌面版)

**🗑️ 緊急清除**
- 新增「**Panic Button**」，一鍵清除 API Key、GAS 網址、通關密語
- 位於雲端同步視窗底部，紅色醒目按鈕

**🔐 後端加固**
- GAS 雲端同步新增「**通關密語**」驗證機制
- 前端傳送 `{ secret, data }` 結構，後端驗證後才允許讀寫
- 內嵌教學程式碼已更新為含驗證版本

**🛡️ 匯出防護**
- 實作 Excel 匯出字串消毒 (`sanitizeForExcel`)
- 自動處理 `=`, `+`, `-`, `@` 開頭字串，防範公式注入攻擊

---

### V7.0 (2026-01-15) - 暖心貓咪版 🐱

**🎨 視覺大改版**
- 全新「貓咪咖啡廳」風格，採用暖色調配色與超圓角設計
- 引入 `Varela Round` + `Noto Sans TC` 雙字型組合
- 所有元件升級為 `rounded-2xl` ~ `rounded-3xl` 圓潤設計

**🧙 新手引導強化**
- 新增 **三步驟引導精靈**：歡迎 → 領取 Key → 輸入 Key
- 新增頂部 **❓ 教學按鈕**，可隨時重新開啟引導
- 新增雲端同步 **內嵌 GAS 教學**，一站式完成後端部署

**📊 行為量表優化**
- 「一鍵預設」按鈕改為 **翠綠色**，視覺更突出
- 題目文字放大至 `15px` + `font-medium`，閱讀更舒適

**📱 RWD 全面升級**
- 手機版側邊欄改為 85% 螢幕寬、僅右側圓角
- 手機版主內容區全屏顯示，無外邊距
- 頂部工具列、Tab 按鈕、輸入框全面優化手機版尺寸

---

### V6.1 (2026-01-15) - 穩定性與匯入強化

- 升級匯入引擎：支援 V6.0 雙層表頭 Excel 匯入
- 新增班級編輯功能：可於貓窩管理中編輯年級、班序與別名
- 強化生成逾時控制：15 秒逾時自動切換模型

### V6.0 (2026-01-14) - 全能行政版

- 新增 Tab 分頁介面：評語生成、行為量表、多元紀錄
- 新增行為量表矩陣：5 大類 25 項指標，內建一鍵預設
- 升級 Excel 匯出引擎：支援雙層表頭與合併儲存格

### V5.x

- V5.2：新增 RWD 響應式設計
- V5.1：新增校務系統匯入格式支援、雙重語氣引擎
- V5.0：新增 Google Sheets 雲端同步 (BYOB 架構)

### V4.0 及更早

- V4.0：多班級管理、Excel 逆向匯入
- V3.0：姓名綁定、八字箴言生成

---

## 📄 版權說明 (License)

MIT License. 歡迎教育工作者自由使用與修改。

---

<p align="center">
  <strong>🐾 喵嗚評語助手 - 溫暖、安全、讓期末評語變得輕鬆療癒 🐾</strong>
</p>
